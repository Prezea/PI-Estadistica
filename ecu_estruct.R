# *******************************************************************************************************
#
# ESTUDIO DE LA DRA. RAYMA
# ANÁLISIS: SERGIO FCO. JUÁREZ CERRILLO 
# FECHA: 8 DE FEBRERO, 2021
#
# *******************************************************************************************************
#

install.packages("githubinstall")
library(githubinstall)
githubinstall("plspm")
library(plspm)


setwd("C:/Users/Sergio/Desktop/Rayma")
datos <- read.csv("BD_1GG.csv", header = TRUE)
names(datos)


# ELIMINAMOS NAs
datos <- na.omit(datos) 
summary(datos)


# MODELO
C1 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C2 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C3 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C4 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C5 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C6 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C7 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C8 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C9 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C10 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
C11 = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0)



MODELO = rbind(C1,C2,C3,C4,C5,C6,C7,C8,C8,C10,C11)

# NOMBRES DE LAS COLUMNAS Y LAS HILERAS
rownames(MODELO) = c("C1","C2","C3","C4","C5","C6","C7", "C8","C9","C10","C11")
colnames(MODELO) = rownames(MODELO)

# BLOQUES DE INDICADORES
#ACOMODAR POR CONSTRUCTO
BLOQUES = list(2:23, 24:26, 27:28, 29:30, 31:34, 35, 36, 37, 38, 2:7, 8:14, 15:19, 20:23, 24:34)

# MODO DE LOS INDICADORES
MODOS = c("A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A")

# AJUSTAMOS MODELO
mod1 = plspm(datos1,MODELO,BLOQUES, modes = MODOS)
mod0 = plspm(datos0,MODELO,BLOQUES, modes = MODOS)

# RESULTADOS

Partial Least Squares Path Modeling (PLS-PM) 
---------------------------------------------
   NAME             DESCRIPTION
1  $outer_model     outer model
2  $inner_model     inner model
3  $path_coefs      path coefficients matrix
4  $scores          latent variable scores
5  $crossloadings   cross-loadings
6  $inner_summary   summary inner model
7  $effects         total effects
8  $unidim          unidimensionality
9  $gof             goodness-of-fit
10 $boot            bootstrap results
11 $data            data matrix
---------------------------------------------
You can also use the function 'summary' 

# ***********************************************************************
#
#  EVALUACIÓN DEL MODELO DE MEDICIÓN 02
# 
#
# ***********************************************************************
# UNIDIMENSIONALIDAD (CONFIABILIDAD)
mod1$unidim
mod0$unidim

> mod1$unidim
         Mode MVs   C.alpha    DG.rho  eig.1st     eig.2nd
CSR         A  22 0.9151638 0.9254673 8.019643 2.168918990
E           A   3 0.6827780 0.8260225 1.843263 0.707272475
W           A   2 0.9981662 0.9990840 1.996339 0.003660843
C           A   2 0.5722243 0.8237993 1.400780 0.599219786
CP          A   4 0.4131337 0.6702882 1.618838 1.103085832
GENDER      A   1 1.0000000 1.0000000 1.000000 0.000000000
AGE         A   1 1.0000000 1.0000000 1.000000 0.000000000
SCHOOL      A   1 1.0000000 1.0000000 1.000000 0.000000000
DURATION    A   1 1.0000000 1.0000000 1.000000 0.000000000
QLC         A   6 0.7234825 0.8133015 2.544505 1.027824287
BE          A   7 0.8714620 0.9024263 4.017004 0.901503776
LCC         A   5 0.8340491 0.8837758 3.028219 0.749028146
CPE         A   4 0.7793907 0.8591040 2.424660 0.683080076
PEB         A  11 0.6484254 0.7103489 2.609373 2.373906299
> mod0$unidim
         Mode MVs   C.alpha    DG.rho   eig.1st    eig.2nd
CSR         A  22 0.9404015 0.9475319 10.125397 2.26214794
E           A   3 0.5171640 0.7556318  1.554525 0.90699614
W           A   2 0.9480313 0.9746738  1.901197 0.09880269
C           A   2 0.3665405 0.7594573  1.224395 0.77560480
CP          A   4 0.5431578 0.7338816  1.976893 1.04323940
GENDER      A   1 1.0000000 1.0000000  1.000000 0.00000000
AGE         A   1 1.0000000 1.0000000  1.000000 0.00000000
SCHOOL      A   1 1.0000000 1.0000000  1.000000 0.00000000
DURATION    A   1 1.0000000 1.0000000  1.000000 0.00000000
QLC         A   6 0.8489128 0.8895557  3.464916 0.94593610
BE          A   7 0.8079883 0.8602970  3.332703 1.27142737
LCC         A   5 0.8144713 0.8718850  2.900901 0.99610701
CPE         A   4 0.8050877 0.8727091  2.527966 0.58332637
PEB         A  11 0.6602484 0.6623826  3.900140 2.10247632


# ***********************************************************************

# VALIDEZ DISCRIMINANTE
# CARGAS Y COMUNALIDADES
mod1$outer_model
mod0$outer_model

> mod1$outer_model
               name    block     weight   loading communality redundancy
1              CVE1      CSR 0.06661483 0.5465943  0.29876528 0.00000000
2              CVE2      CSR 0.06004195 0.4609452  0.21247046 0.00000000
3              CVE3      CSR 0.06534892 0.5306298  0.28156803 0.00000000
4              CVE4      CSR 0.07130513 0.5651399  0.31938310 0.00000000
5              CVE5      CSR 0.07204545 0.5321796  0.28321516 0.00000000
6              CVE8      CSR 0.06101777 0.4456192  0.19857649 0.00000000
7               ET1      CSR 0.07775116 0.6228062  0.38788757 0.00000000
8               ET2      CSR 0.06931633 0.6068757  0.36829806 0.00000000
9               ET3      CSR 0.08446222 0.7187990  0.51667200 0.00000000
10              ET4      CSR 0.08243787 0.6935393  0.48099678 0.00000000
11              ET5      CSR 0.07470750 0.6311776  0.39838520 0.00000000
12              ET6      CSR 0.06799339 0.5913820  0.34973272 0.00000000
13              ET8      CSR 0.07131592 0.6216790  0.38648477 0.00000000
14              VC1      CSR 0.08478697 0.6997611  0.48966559 0.00000000
15              VC3      CSR 0.07924586 0.6350227  0.40325382 0.00000000
16              VC4      CSR 0.08307777 0.6221847  0.38711378 0.00000000
17              VC5      CSR 0.08395947 0.6638966  0.44075864 0.00000000
18              VC6      CSR 0.07629028 0.6109189  0.37322189 0.00000000
19            CyPA2      CSR 0.07653468 0.5584564  0.31187352 0.00000000
20            CyPA6      CSR 0.08923522 0.6949984  0.48302275 0.00000000
21            CyPA7      CSR 0.08046907 0.5965989  0.35593029 0.00000000
22            CyPA8      CSR 0.07277670 0.5341579  0.28532469 0.00000000
23            CPAE1        E 0.47818808 0.8220683  0.67579625 0.00000000
24            CPAE2        E 0.46495491 0.7499964  0.56249459 0.00000000
25            CPAE3        E 0.33639921 0.7674877  0.58903730 0.00000000
26            CPAA2        W 0.50180190 0.9990893  0.99817939 0.00000000
27            CPAA3        W 0.49911456 0.9990794  0.99815974 0.00000000
28            CPAC1        C 0.51891801 0.7881570  0.62119153 0.00000000
29            CPAC3        C 0.67178726 0.8797593  0.77397648 0.00000000
30           CPACP1       CP 0.50982999 0.8263998  0.68293656 0.00000000
31           CPACP2       CP 0.35473946 0.5679989  0.32262275 0.00000000
32           CPACP4       CP 0.46342799 0.7559776  0.57150213 0.00000000
33           CPACP5       CP 0.15946468 0.1683371  0.02833737 0.00000000
34      CPASCGenero   GENDER 1.00000000 1.0000000  1.00000000 0.00000000
35        CPASCEdad      AGE 1.00000000 1.0000000  1.00000000 0.00000000
36 CPASCEscolaridad   SCHOOL 1.00000000 1.0000000  1.00000000 0.00000000
37  CPASCAntEmpresa DURATION 1.00000000 1.0000000  1.00000000 0.00000000
38             CVE1      QLC 0.27281496 0.5871262  0.34471718 0.21819105
39             CVE2      QLC 0.23006558 0.6572739  0.43200903 0.27344301
40             CVE3      QLC 0.26484646 0.6990208  0.48863004 0.30928166
41             CVE4      QLC 0.28207322 0.7417250  0.55015592 0.34822488
42             CVE5      QLC 0.26562257 0.6409883  0.41086605 0.26006042
43             CVE8      QLC 0.22241829 0.5574730  0.31077610 0.19670781
44              ET1       BE 0.18384955 0.6235707  0.38884046 0.28269635
45              ET2       BE 0.17914607 0.7404993  0.54833925 0.39865580
46              ET3       BE 0.21218544 0.8670500  0.75177572 0.54655900
47              ET4       BE 0.20472884 0.8360405  0.69896366 0.50816336
48              ET5       BE 0.18631981 0.8093670  0.65507497 0.47625523
49              ET6       BE 0.17457272 0.7698998  0.59274567 0.43094034
50              ET8       BE 0.18351714 0.6122462  0.37484538 0.27252159
51              VC1      LCC 0.27871843 0.7995294  0.63924723 0.44469502
52              VC3      LCC 0.25293408 0.8434434  0.71139679 0.49488617
53              VC4      LCC 0.24782090 0.7642778  0.58412049 0.40634587
54              VC5      LCC 0.26443437 0.8124448  0.66006660 0.45917810
55              VC6      LCC 0.24333220 0.6558051  0.43008034 0.29918720
56            CyPA2      CPE 0.30113548 0.7166658  0.51360993 0.30801613
57            CyPA6      CPE 0.37475971 0.8505716  0.72347202 0.43387216
58            CyPA7      CPE 0.32169982 0.7076469  0.50076418 0.30031243
59            CyPA8      CPE 0.28803121 0.8255239  0.68148965 0.40869499
60            CPAE1      PEB 0.17637648 0.4705215  0.22139053 0.22117671
61            CPAE2      PEB 0.18559271 0.4574869  0.20929422 0.20909208
62            CPAE3      PEB 0.12555350 0.3310094  0.10956725 0.10946143
63            CPAA2      PEB 0.20143384 0.4636351  0.21495747 0.21474987
64            CPAA3      PEB 0.20192371 0.4611511  0.21266031 0.21245492
65            CPAC1      PEB 0.16621008 0.4287136  0.18379538 0.18361787
66            CPAC3      PEB 0.21421215 0.5549967  0.30802136 0.30772388
67           CPACP1      PEB 0.24089724 0.6716578  0.45112424 0.45068855
68           CPACP2      PEB 0.20188348 0.4673668  0.21843173 0.21822076
69           CPACP4      PEB 0.22412193 0.6105040  0.37271518 0.37235521
70           CPACP5      PEB 0.09958707 0.2099796  0.04409143 0.04404885
> mod0$outer_model
               name    block       weight     loading  communality   redundancy
1              CVE1      CSR  0.063797956  0.65846906 0.4335815029 0.0000000000
2              CVE2      CSR  0.081487802  0.83844447 0.7029891209 0.0000000000
3              CVE3      CSR  0.038984613  0.35107855 0.1232561471 0.0000000000
4              CVE4      CSR  0.080759257  0.82193663 0.6755798301 0.0000000000
5              CVE5      CSR  0.068098798  0.70346418 0.4948618475 0.0000000000
6              CVE8      CSR  0.074010974  0.75125593 0.5643854662 0.0000000000
7               ET1      CSR  0.053281351  0.53887680 0.2903882058 0.0000000000
8               ET2      CSR  0.056448421  0.57216510 0.3273728966 0.0000000000
9               ET3      CSR  0.078898146  0.76437891 0.5842751246 0.0000000000
10              ET4      CSR  0.068078168  0.71137583 0.5060555698 0.0000000000
11              ET5      CSR  0.074827419  0.73069770 0.5339191282 0.0000000000
12              ET6      CSR  0.057798886  0.60469392 0.3656547355 0.0000000000
13              ET8      CSR  0.048542436  0.42081337 0.1770838953 0.0000000000
14              VC1      CSR  0.082068672  0.78935112 0.6230751912 0.0000000000
15              VC3      CSR  0.041792360  0.50401743 0.2540335683 0.0000000000
16              VC4      CSR  0.037732273  0.47878613 0.2292361550 0.0000000000
17              VC5      CSR  0.077037878  0.76345367 0.5828615117 0.0000000000
18              VC6      CSR  0.075541525  0.75796741 0.5745145988 0.0000000000
19            CyPA2      CSR  0.073805403  0.75769437 0.5741007642 0.0000000000
20            CyPA6      CSR  0.074264285  0.73236157 0.5363534715 0.0000000000
21            CyPA7      CSR  0.073410372  0.71433026 0.5102677163 0.0000000000
22            CyPA8      CSR  0.064442472  0.67597793 0.4569461668 0.0000000000
23            CPAE1        E -0.495514505  0.81290569 0.6608156645 0.0000000000
24            CPAE2        E -0.579720872  0.83390823 0.6954029376 0.0000000000
25            CPAE3        E -0.259625829  0.43816685 0.1919901894 0.0000000000
26            CPAA2        W  0.533957924  0.97703336 0.9545941821 0.0000000000
27            CPAA3        W  0.491651968  0.97285342 0.9464437683 0.0000000000
28            CPAC1        C  0.991815738  0.99945023 0.9989007541 0.0000000000
29            CPAC3        C  0.034022512  0.25658120 0.0658339125 0.0000000000
30           CPACP1       CP -0.087145978 -0.11285528 0.0127363148 0.0000000000
31           CPACP2       CP  0.336851217  0.72567260 0.5266007152 0.0000000000
32           CPACP4       CP  0.450782322  0.83050872 0.6897447315 0.0000000000
33           CPACP5       CP  0.430853206  0.86187770 0.7428331710 0.0000000000
34      CPASCGenero   GENDER  1.000000000  1.00000000 1.0000000000 0.0000000000
35        CPASCEdad      AGE  1.000000000  1.00000000 1.0000000000 0.0000000000
36 CPASCEscolaridad   SCHOOL  1.000000000  1.00000000 1.0000000000 0.0000000000
37  CPASCAntEmpresa DURATION  1.000000000  1.00000000 1.0000000000 0.0000000000
38             CVE1      QLC  0.205293144  0.71502382 0.5112590572 0.4456726123
39             CVE2      QLC  0.261406067  0.89031180 0.7926550972 0.6909699944
40             CVE3      QLC  0.109456960  0.51297802 0.2631464490 0.2293889247
41             CVE4      QLC  0.256259738  0.83159495 0.6915501635 0.6028352234
42             CVE5      QLC  0.219321846  0.78019055 0.6086972922 0.5306110640
43             CVE8      QLC  0.234222792  0.76897494 0.5913224568 0.5154651450
44              ET1       BE  0.177815763  0.49424479 0.2442779106 0.2062610324
45              ET2       BE  0.188800792  0.70434170 0.4960972330 0.4188898096
46              ET3       BE  0.252225107  0.77735596 0.6042822945 0.5102380713
47              ET4       BE  0.234735778  0.82691706 0.6837918313 0.5773735691
48              ET5       BE  0.241111757  0.77462225 0.6000396329 0.5066556935
49              ET6       BE  0.199532888  0.63855275 0.4077496181 0.3442917004
50              ET8       BE  0.138857824  0.53851266 0.2899958848 0.2448639357
51              VC1      LCC  0.309499726  0.80866012 0.6539311904 0.5151780063
52              VC3      LCC  0.197621957  0.68143575 0.4643546781 0.3658264368
53              VC4      LCC  0.187727324  0.56366002 0.3177126211 0.2502993543
54              VC5      LCC  0.299345324  0.87144594 0.7594180311 0.5982823162
55              VC6      LCC  0.297194939  0.83573291 0.6984495043 0.5502502839
56            CyPA2      CPE  0.330699161  0.83236265 0.6928275833 0.5697143201
57            CyPA6      CPE  0.319643084  0.82252858 0.6765532694 0.5563319001
58            CyPA7      CPE  0.311774492  0.76261568 0.5815826826 0.4782372853
59            CyPA8      CPE  0.295033563  0.75943454 0.5767408235 0.4742558091
60            CPAE1      PEB -0.152447196 -0.46387807 0.2151828621 0.2150965468
61            CPAE2      PEB -0.207418278 -0.54270146 0.2945248694 0.2944067279
62            CPAE3      PEB -0.075149650 -0.24303993 0.0590684076 0.0590447138
63            CPAA2      PEB  0.162763070  0.73272126 0.5368804502 0.5366650937
64            CPAA3      PEB  0.131225416  0.67466580 0.4551739434 0.4549913615
65            CPAC1      PEB  0.199923219  0.79583023 0.6333457514 0.6330917002
66            CPAC3      PEB -0.002892447  0.02727142 0.0007437306 0.0007434323
67           CPACP1      PEB -0.031792174 -0.15460168 0.0239016808 0.0238920932
68           CPACP2      PEB  0.165617676  0.59749931 0.3570054271 0.3568622231
69           CPACP4      PEB  0.211894281  0.79957318 0.6393172659 0.6390608193
70           CPACP5      PEB  0.207184202  0.76423127 0.5840494286 0.5838151514
> 


# VALIDEZ CONVERGENTE
# CARGAS CRUZADAS
cbind(mod1$crossloadings[,seq(1,2)],round(mod1$crossloadings[,seq(3,16,1)],2))
cbind(mod0$crossloadings[,seq(1,2)],round(mod0$crossloadings[,seq(3,16,1)],2))
# ***********************************************************************
#
#  FIN DEL MODELO 03
#
# ***********************************************************************

# ***********************************************************************
#
#  EVALUACIÓN DEL MODELO ESTRUCTURAL
#  (SÓLO DESPUÉS DE QUE SE HA EVALUADO Y APROBADO AL MODELO DE MEDICIÓN)
#
# ***********************************************************************
# MODELO ESTRUCTURAL
mod1$inner_model
mod0$inner_model

mod1$inner_summary
mod0$inner_summary

# EFECTOS
mod1$effects
mod0$effects

# GOF
mod1$gof
mod0$gof





